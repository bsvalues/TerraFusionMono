{% extends 'base.html' %}

{% block page_title %}Import Tax District Data{% endblock %}
{% block page_subtitle %}Upload tax district relationships from text, XML, or Excel files{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Tax District File Upload</h5>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="file" class="form-label">Select District Data File</label>
                        <input type="file" class="form-control" id="file" name="file" required>
                        <div class="form-text text-muted">
                            Upload a text (tab-delimited), XML, or Excel file (.xlsx/.xls) containing tax district relationships.
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6 class="alert-heading mb-2">Supported File Formats</h6>
                        <p class="mb-1">The following file formats are supported:</p>
                        <ul class="mb-0">
                            <li><strong>Text files (.txt)</strong> - Tab-delimited with columns for tax_district_id, year, levy_code, and linked_levy_code</li>
                            <li><strong>XML files (.xml)</strong> - Structured data with TaxDistrict elements containing DistrictID, Year, LevyCode, and LinkedLevyCode nodes</li>
                            <li><strong>Excel files (.xlsx/.xls)</strong> - Spreadsheet with columns for tax_district_id, year, levy_code, and linked_levy_code</li>
                        </ul>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-upload me-1"></i> Upload District Data
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">About Tax Districts</h5>
            </div>
            <div class="card-body">
                <p>
                    Tax districts represent specific geographic areas with defined taxation authority. Each district is associated 
                    with one or more levy codes that determine the tax rates applied to properties within the district.
                </p>
                
                <div class="alert alert-secondary">
                    <h6 class="alert-heading mb-2">File Format Requirements</h6>
                    
                    <h6 class="mt-3 mb-2">Text Files</h6>
                    <p class="mb-2">Tab-delimited text files should contain the following columns:</p>
                    <table class="table table-sm table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Column</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>tax_district_id</td>
                                <td>Unique identifier for the tax district</td>
                                <td>101</td>
                            </tr>
                            <tr>
                                <td>year</td>
                                <td>Tax year for the district relationship</td>
                                <td>2023</td>
                            </tr>
                            <tr>
                                <td>levy_code</td>
                                <td>The primary levy code for the district</td>
                                <td>A101</td>
                            </tr>
                            <tr>
                                <td>linked_levy_code</td>
                                <td>A related levy code linked to the primary code</td>
                                <td>B202</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h6 class="mt-3 mb-2">XML Files</h6>
                    <p class="mb-2">XML files should follow this structure:</p>
                    <pre class="bg-dark text-light p-2 rounded">
&lt;TaxDistricts&gt;
    &lt;TaxDistrict&gt;
        &lt;DistrictID&gt;101&lt;/DistrictID&gt;
        &lt;Year&gt;2023&lt;/Year&gt;
        &lt;LevyCode&gt;A101&lt;/LevyCode&gt;
        &lt;LinkedLevyCode&gt;B202&lt;/LinkedLevyCode&gt;
    &lt;/TaxDistrict&gt;
    &lt;!-- Additional districts... --&gt;
&lt;/TaxDistricts&gt;</pre>

                    <h6 class="mt-3 mb-2">Excel Files</h6>
                    <p class="mb-2">Excel files (.xlsx or .xls) should contain the following columns:</p>
                    <table class="table table-sm table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>Column</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>tax_district_id</td>
                                <td>Unique identifier for the tax district</td>
                                <td>101</td>
                            </tr>
                            <tr>
                                <td>year</td>
                                <td>Tax year for the district relationship</td>
                                <td>2023</td>
                            </tr>
                            <tr>
                                <td>levy_code</td>
                                <td>The primary levy code for the district</td>
                                <td>A101</td>
                            </tr>
                            <tr>
                                <td>linked_levy_code</td>
                                <td>A related levy code linked to the primary code</td>
                                <td>B202</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-muted small">Note: The first row of the Excel file should contain the column headers exactly as shown above.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}